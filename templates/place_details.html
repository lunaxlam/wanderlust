{% extends 'base.html' %}
{% block title %}{{ results["name"] }}{% endblock %}


{% block body %}
<div class="container">
    <div class="row align-items-start">
        <div class="col">
            {% if "website" in results %}
                <h1 class="text-center"><a href="{{ results['website'] }}" target="_blank">{{ results["name"] }}</a></h1>
            {% else %}
                <h1 class="text-center">{{ results["name"] }}</h1>
            {% endif %}

            {% if "rating" in results %}
                <h5>Rating</h5> 
                <p>{{ results["rating"] }} out of {{ results["user_ratings_total"] }} reviews</p>
            {% endif %}

            {% if "formatted_address" in results %}
                <h5>Address</h5>
                <a href="{{ results['url'] }}" target="_blank">{{ results["formatted_address"] }}</a>
            {% endif %}
            
            {% if "phone" in results %}
                <h5>Phone</h5>
                <p> {{ results["phone"] }}</p>
            {% endif %}

            {% if "website" in results %}
                <h5>Website</h5>
                <a href="{{ results['website'] }}" target="_blank">{{ results["name"] }}</a>
            {% endif %}

            {% if "hours" in results %}
                <h5>Business Hours</h5> 
                <ul>
                {% for hour in hours %}
                    <li>{{ hour }}</li>
                {% endfor %}
                </ul>
            {% endif %}

            {% if results["opening_hours"]["weekday_text"] %}
                <h5>Operating Hours</h5>
                <ul>
                    {% for text in results["opening_hours"]["weekday_text"] %}
                        <li>{{ text }}<li>
                    {% endfor %}
                </ul>
            {% endif %}

            <div id="place-map" class="all-maps"></div>

            {% if "reviews" in results %}
                <h3>Recent Reviews:</h3>
                {% for review in results["reviews"] %}
                    <section class="review-card text-center">
                        <a href='{{ review["author_url"] }}' target="_blank"><img src='{{ review["profile_photo_url"] }}' class="profile-pic"></a>
                        <a href='{{ review["author_url"] }}' target="_blank"><p class="main-heading">{{ review["author_name"] }}</p></a>
                        <p>Rating: {{ review["rating"] }}/5</p>
                        <br />
                        <p>{{ review["text"] }}</p>
                    </section>
                {% endfor %}
            {% endif %}
        </div>

        <div class="col sticky-top sticky-margin">
            <h2 id="form-large" class="center-text">Ready to add <span class="main-heading">{{ results["name"] }}</span> to Itinerary?</h2>
                
            <form class="row g-3" action="/itinerary/{{ itinerary_id }}/{{ place_id }}/add_activity">
                <div class="col-md-6">
                    <label for="activity-start" class="form-label">Start</label>
                    <input type="datetime-local" class="form-control" name="start" id="activity-start">
                </div>
                <div class="col-md-6">
                    <label for="activity-end" class="form-label">End</label>
                    <input type="datetime-local" class="form-control" name="end" id="activity-end">
                </div>
                <div class="col-md-12">
                    <label for="activity-notes" class="form-label">Activity Notes</label>
                    <textarea name="notes" id="activity-notes" class="form-control"></textarea>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </form>

        </div>
    </div>
</div>

{% endblock %}

{% block js %}
    <!-- <script src="/static/js/formSticky.js"></script> -->
    <!-- Maps API -->
    <script src="/static/js/apiMapsPlaceSearch.js"></script>
    <script async
        src="https://maps.googleapis.com/maps/api/js?key={{ API_KEY }}&libraries=places&callback=initMap">
    </script>
{% endblock %}
